<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CipherCircle</title>

<style>
:root{
  --bg:#020617;
  --panel:#0f172a;
  --text:#e5e7eb;
  --muted:#94a3b8;
  --accent:#38bdf8;
  --border-dark:#1e293b;
  --success:#22c55e;
  --error:#ef4444;
}

*{box-sizing:border-box}

body{
  margin:0;
  padding:14px;
  font-family:system-ui,sans-serif;
  background:radial-gradient(circle at top,#0b122f,var(--bg) 70%);
  color:var(--text);
}

.container{
  position:relative;
  max-width:520px;
  margin:auto;
  padding:16px;
  background:var(--panel);
  border-radius:14px;
}

/* BORDA */
.container::before{
  content:"";
  position:absolute;
  inset:0;
  padding:1.5px;
  border-radius:14px;
  background:linear-gradient(
    90deg,
    transparent,
    var(--accent),
    #fff,
    var(--accent),
    transparent
  );
  background-size:300% 300%;
  animation:borderFlow 14s linear infinite;
  -webkit-mask:
    linear-gradient(#fff 0 0) content-box,
    linear-gradient(#fff 0 0);
  -webkit-mask-composite:xor;
          mask-composite:exclude;
  pointer-events:none;
}

.container.active::before{animation-duration:3s}
.container.success::before{background:linear-gradient(90deg,transparent,var(--success),transparent)}
.container.error::before{background:linear-gradient(90deg,transparent,var(--error),transparent)}

@keyframes borderFlow{
  from{background-position:0% 50%}
  to{background-position:300% 50%}
}

h1{
  text-align:center;
  font-size:18px;
  letter-spacing:2px;
  color:var(--accent);
}

input,textarea,button{
  width:100%;
  margin-top:10px;
  padding:12px;
  border-radius:10px;
  border:1px solid var(--border-dark);
  background:#020617;
  color:var(--text);
  text-align:center;
  font-size:15px;
}

textarea{height:120px;resize:none}

button{
  border:none;
  background:linear-gradient(135deg,#0ea5e9,#2563eb);
  font-weight:600;
  cursor:pointer;
}

.secondary{
  background:transparent;
  border:1px solid var(--accent);
  color:var(--accent);
}

.footer{
  text-align:center;
  font-size:11px;
  color:var(--muted);
  margin-top:12px;
}
</style>
</head>

<body>

<div class="container" id="container">
  <h1>CIPHER CIRCLE</h1>

  <input id="chave" placeholder="Chave secreta">
  <textarea id="entrada" placeholder="Digite ou cole o texto"></textarea>

  <button onclick="processar()">Enviar</button>
  <button onclick="colar()">Colar</button>
  <button onclick="copiar()">Copiar resultado</button>
  <button class="secondary" onclick="limpar()">Apagar texto</button>

  <textarea id="saida" placeholder="Resultado"></textarea>

  <div class="footer">offline · privado · local</div>
</div>

<script>
const alfabeto="abcdefghijklmnopqrstuvwxyz ";
const simbolos="@#$&+_-()=!?:;";
const container=document.getElementById("container");

function efeito(tipo){
  container.classList.add(tipo);
  setTimeout(()=>container.classList.remove(tipo),700);
}

function gerarMapas(chave){
  let seed=0;
  for(let c of chave) seed+=c.charCodeAt(0);

  let destino=alfabeto.split("").reverse().join("").replace(" ","|");
  destino=destino.slice(seed%destino.length)+destino.slice(0,seed%destino.length);

  "aeiou".split("").forEach((v,i)=>{
    destino=destino.replace(v,simbolos[i]);
  });

  let mapa={},inv={};
  for(let i=0;i<alfabeto.length;i++){
    mapa[alfabeto[i]]=destino[i];
    inv[destino[i]]=alfabeto[i];
  }
  return{mapa,inv};
}

function pareceCodificado(texto){
  return /[@#$&+_\-()=!?:;|]/.test(texto);
}

function processar(){
  if(!chave.value){efeito("error");return;}

  const texto=entrada.value;
  if(!texto.trim()) return;

  const{mapa,inv}=gerarMapas(chave.value.toLowerCase());

  saida.value = pareceCodificado(texto)
    ? [...texto].map(c=>inv[c]??c).join("")
    : [...texto.toLowerCase()].map(c=>mapa[c]??c).join("");

  efeito("active");
}

async function colar(){
  if(!chave.value){efeito("error");return;}
  let texto;
  try{
    texto=await navigator.clipboard.readText();
  }catch{
    efeito("error");
    return;
  }
  entrada.value=texto;
  processar();
}

async function copiar(){
  try{
    await navigator.clipboard.writeText(saida.value);
    entrada.value="";
    saida.value="";
    efeito("success");
  }catch{
    efeito("error");
  }
}

function limpar(){
  entrada.value="";
  saida.value="";
}
</script>

</body>
</html>
